<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/index.css" />
        <link rel="stylesheet" type="text/css" href="css/menu.css" />
        <link rel="stylesheet" type="text/css" href="res/jquerymobile/jquery.mobile-1.4.5.min.css" />
        <link rel="stylesheet" type="text/css" href="res/jquerymobile/jquery.mobile.theme-1.4.5.min.css" />

        <script type="text/javascript" src="js/jquery.js"></script>
        <script type="text/javascript" src="res/jquerymobile/jquery.mobile-1.4.5.min.js"></script>
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/urlHelper.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script type="text/javascript" src="js/main-config.js"></script>
        <script type="text/javascript" src="js/menu.js"></script>
        <script type="text/javascript" src="js/localhelper.js"></script>

        <title>LAP - La conduite</title>
    </head>
    <body>
        <div id="menu">
            <h3>Menu</h3>
            <ul>
                <li class="active"><a href="#home" class="contentLink">Profil </a></li>
                <li><a href="mesTrajets.html" class="contentLink">Trajets </a></li>
                <li><a href="#home" class="contentLink">Nouveau </a></li>
                <li><a href="#home" class="contentLink">Navigation </a></li>
            </ul>
        </div>

        <div data-role="page" id="page-testTrajet">
            <div data-role="header" data-theme="a">
                <a href="#"class="showMenu">Menu</a>
                <h1>Mes Trajets</h1>
            </div>

            <div data-role="content">
                <h2>Test trajets</h2>
                <ul data-role="listview" data-inset="true">
                    <li><a href="#page-listeTrajets" data-icon="custom">Mes Trajets</a></li>
                </ul>
            </div>

            <div data-role="footer" data-position="fixed" data-tap-toggle="false">

            </div>

            <script type="text/javascript">
                var trajet1 = {
                    depart: 'Chez michel',
                    arrivee: 'Chez quentin',
                    nb_km: 12,
                    temps: 25,
                    vitesse_moyenne: 50,
                    meteo: 'soleil',
                    type_route: 'campagne',
                    jour_nuit: 'jour'
                };

                var trajet2 = {
                    depart: 'Chez Damien',
                    arrivee: 'Chez Renaud',
                    nb_km: 40,
                    temps: 30,
                    vitesse_moyenne: 86,
                    meteo: 'soleil',
                    type_route: 'campagne',
                    jour_nuit: 'jour'
                };
                Locstor.set('trajet_1', trajet1);
                Locstor.set('trajet_2', trajet2);
            </script>
        </div>

        <div data-role="page" id="page-listeTrajets" >
            <div data-role="header" data-theme="a">
                <a href="#"class="showMenu">Menu</a>
                <h1>Trajets Parcourus</h1>
            </div>

            <div data-role="content">
                <h2>Mes trajets</h2>
                <ul data-role="listview" data-inset="true" id="liste_effectuees"></ul>
            </div>

            <script>
                var a = Locstor.list('trajet_');
                $.each(a, function (i) {
                    var monTrajet = Locstor.get(a[i]);
                    var liste_trajets = $('#liste_effectuees');
                    liste_trajets.append('<li data-name="'+a[i]+'"><a href="#page-detailsTrajet" data-icon="custom">De '+monTrajet.depart+' vers '+monTrajet.arrivee+'</a></li>')

                });

                $('ul').children('li').on('click', function () {
                    Locstor.set('courant_trajet', $(this).attr('data-name'));
                });
            </script>
        </div>

        <div data-role="page" id="page-detailsTrajet" >
            <div data-role="header" data-theme="a">
                <a href="#"class="showMenu">Menu</a>
                <h1>Détails de mon trajet</h1>
            </div>

            <div data-role="content">
                <h2>Details</h2>

                <table>
                    <tr>
                        <td>Départ</td>
                        <td id="text-depart"></td>
                    </tr>

                    <tr>
                       <td>Arrivée</td>
                        <td id="text-arrivee"></td>
                    </tr>

                    <tr>
                        <td>Nombre de kilomètre</td>
                        <td id="text-km"></td>
                    </tr>

                    <tr>
                        <td>Temps</td>
                        <td id="text-temps"></td>
                    </tr>

                    <tr>
                        <td>Vitesse moyenne</td>
                        <td id="text-vitesse"></td>
                    </tr>

                    <tr>
                        <td>Météo</td>
                        <td id="text-meteo"></td>
                    </tr>

                    <tr>
                        <td>Type de route</td>
                        <td id="text-route"></td>
                    </tr>

                    <tr>
                        <td>Période</td>
                        <td id="text-periode"></td>
                    </tr>
                </table>
            </div>

            <script type="text/javascript">
                $(document).on('pagebeforeshow', '#page-detailsTrajet', function (e, data) {
                    var monTrajet = Locstor.get(Locstor.get('courant_trajet'));
                    $('#text-depart').html(monTrajet.depart);
                    $('#text-arrivee').html(monTrajet.arrivee);
                    $('#text-km').html(monTrajet.nb_km);
                    $('#text-temps').html(monTrajet.temps);
                    $('#text-vitesse').html(monTrajet.vitesse_moyenne);
                    $('#text-meteo').html(monTrajet.meteo);
                    $('#text-route').html(monTrajet.type_route);
                    $('#text-periode').html(monTrajet.jour_nuit);
                });
            </script>
        </div>

        <script type="text/javascript">
            // pour initialiser l'app
            app.initialize();
        </script>
    </body>
</html>
